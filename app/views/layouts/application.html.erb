<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <title><%= BOARDTITLE %></title>
    <%= stylesheet_link_tag "application" %>
    <%= stylesheet_link_tag "mobile" if mobile_device? %>
    <% theme_basenames.each do |t| %>
      <%= stylesheet_link_tag "themes/" + t, :title => t %>
    <% end %>
    <%= javascript_include_tag "application" %>
    <%= csrf_meta_tag %>
  </head>
  <body>
    <header>
      <div id="themes">
        <%= link_to image_tag('/assets/3d.png', height: 24, width: 24), '#',
            class: 'set-theme', data: { theme: '3d' }
        %>
        <% theme_basenames.each do |t| %>
          <%= link_to t, "#", class: 'set-theme', data: { theme: "#{t}" } %>
        <% end %>
        <%= link_to 'big', 'https://bigchan.herokuapp.com/', target: '_blank' %>
        <a href="javascript:%20(function%20()%20{%20%20const%20css%20=%20`%20%20%20%20:root%20{%20%20%20%20%20%20--filter-chain:%20sepia(90%)%20invert(100%)%20hue-rotate(180deg)%20blur(0.2px)%20brightness(170%);%20%20%20%20}%20%20%20%20body%20{%20%20%20%20%20%20background-blend-mode:%20overlay;%20%20%20%20%20%20background-color:%20#0A0A0A;%20%20%20%20%20%20text-shadow:%20%20%20%20%20%20%20%200%200%205px%20rgba(1,%201,%201,%200.8),%20%20%20%20%20%20%20%200%200%201em%20rgba(255,%20200,%20200,%200.6),%20%20%20%20%20%20%20%200%200%2010px%20rgba(255,%20192,%20192,%200.3);%20%20%20%20}%20%20%20%20body%20>%20*:not(.mt-overlay)%20{%20%20%20%20%20%20background-blend-mode:%20overlay;%20%20%20%20%20%20background-color:%20transparent;%20%20%20%20%20%20filter:%20var(--filter-chain)%20!important;%20%20%20%20%20%20-webkit-filter:%20var(--filter-chain)%20!important;%20%20%20%20}%20%20%20%20img,%20video%20{%20%20%20%20%20%20--filter-chain:%20invert(100%)%20blur(1px)%20brightness(80%);%20%20%20%20%20%20filter:%20var(--filter-chain);%20%20%20%20%20%20-webkit-filter:%20var(--filter-chain);%20%20%20%20}%20%20%20%20.mt-overlay%20{%20%20%20%20%20%20position:%20fixed;%20%20%20%20%20%20top:%200;%20%20%20%20%20%20left:%200;%20%20%20%20%20%20width:%20100%;%20%20%20%20%20%20height:%20100%;%20%20%20%20%20%20z-index:%202147483647;%20%20%20%20%20%20pointer-events:%20none;%20%20%20%20}%20%20%20%20#mt-grill%20{%20%20%20%20%20%20background-image:%20url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAJ1BMVEUAAGwAANkAAP8ALAAANAAAbAAA2QAA3gAA4QAA/wBsAADZAAD/AACoIOABAAAAVUlEQVR42u2RwQ3AIAwDHVoMIew/bxdIJPj14Z91VhRLhxWxOtlhdpQRewfdaa3ZSb4+uJ/EJ68rDp/5gIrDR15UHPPNX1dcHuRBHuRBHuRBHv7r4QOHFTeZ7vvIdwAAAABJRU5ErkJggg==);%20%20%20%20%20%20background-size:%2017px;%20%20%20%20%20%20mix-blend-mode:%20soft-light;%20%20%20%20}%20%20%20%20#mt-noise%20{%20%20%20%20%20%20background-image:%20url(https://gyng.github.io/maketerm/i/noise.gif);%20/*%20Too%20big%20for%20a%20bookmarklet%20*/%20%20%20%20%20%20background-size:%2060px;%20%20%20%20%20%20mix-blend-mode:%20hard-light;%20%20%20%20%20%20opacity:%200.4;%20%20%20%20}%20%20%20%20#mt-scanlines%20{%20%20%20%20%20%20background-image:%20url(https://gyng.github.io/maketerm/i/scanlines.gif);%20/*%20Too%20big%20for%20a%20bookmarklet%20*/%20%20%20%20%20%20background-size:%20192px;%20%20%20%20%20%20mix-blend-mode:%20screen;%20%20%20%20%20%20opacity:%200.1;%20%20%20%20}%20%20%20%20#mt-orange%20{%20%20%20%20%20%20background-color:%20#FCE05F;%20%20%20%20%20%20mix-blend-mode:%20color-burn;%20%20%20%20%20%20opacity:%200.5;%20%20%20%20}%20%20`;%20%20const%20style%20=%20document.createElement('style');%20%20style.type%20=%20'text/css';%20%20if%20(style.styleSheet)%20{%20%20%20%20style.styleSheet.cssText%20=%20css;%20%20}%20else%20{%20%20%20%20style.appendChild(document.createTextNode(css));%20%20}%20%20document.head.appendChild(style);%20%20const%20makeOverlay%20=%20(id)%20=>%20Object.assign(document.createElement('div'),%20{%20id,%20className:%20'mt-overlay'%20});%20%20const%20makeAndAddOverlay%20=%20(id)%20=>%20document.body.appendChild(makeOverlay(id));%20%20['mt-grill',%20'mt-noise',%20'mt-scanlines',%20'mt-orange'].forEach(makeAndAddOverlay);%20%20console.log('%EF%BC%A8%EF%BC%A5%EF%BC%AC%EF%BC%AC%EF%BC%AF%E3%80%80%EF%BC%B7%EF%BC%AF%EF%BC%B2%EF%BC%AC%EF%BC%A4');}());"><%= image_tag('/assets/tv.png', width: 24, alt: 'TV mode') %></a>
      </div>
      <h1><%= link_to BOARDTITLE, "/" %></h1>
      <% board_listing.each do |board| %>
        <% if current_board(board) %>
          <%= "/#{board.name}/" %>
        <% else %>
          <%= link_to "/#{board.name}/", board %>
        <% end %>
      <% end %>
      <% flash.each do |key, value| %>
        <div class="flash_#{key}">
          <h2><%=value%></h2>
        </div>
      <% end %>
    </header>
    <div id="forttree-content-container">
      <div id="forttree-3d-content"></div>
      <div id="forttree-content">
        <%= yield %>
      </div>
    </div>
  <body>
</html>
